var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,c){for(var b=1;b<arguments.length;b++){var d=arguments[b];if(d)for(var e in d)$jscomp.owns(d,e)&&(a[e]=d[e])}return a};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
app.controller("LibraryCtrl",["$scope","$q","$window","$uibModal","$timeout","$filter","$document","GoogleService","AirtableChoirService","AirtableFilesService","AppUtil",function(a,c,b,d,e,l,m,n,f,g,h){a.init=function(){a.songs=[];a.categories=[];a.authors=[];a.song={};a.dateFormat="DD, dd/mm/yy";a.driveURL=g.getDriveURL();a.pageSize=10;a.pageCounter=1;a.maxSize=7;m.ready(function(){0===b.angular.element(".signin").length&&a.loadData().then(function(){a.get()})})};a.signin=function(b,c){a.profile=
b;a.accessToken=c;n.setAccessToken(c);a.loadData().then(function(){a.get()})};a.get=function(){var c=[{width:"calc(50% - 16)",targets:0},{width:"35%",targets:1},{width:"15%",targets:2},{width:16,targets:3,visible:null!==a.accessToken&&void 0!==a.accessToken,searchable:!1,orderable:!1},{width:0,targets:4,visible:!1,type:"hidden"}];e(function(){$(".table").DataTable({language:{url:"../../resources/js/datatables-vi.json"},columns:c,autoWidth:!1,ordering:!1,pageLength:15,lengthMenu:[[10,15,25,50,-1],
[10,15,25,50,"All"]],dom:'<fpl<t>i<"dataTables_drive">>',initComplete:function(){a.accessToken&&$(".dataTables_drive").append('Danh S\u00e1ch B\u00e0i H\u00e1t \u27a1 <a href="'+a.driveURL+'" target="_blank" title="Danh S\u00e1ch B\u00e0i H\u00e1t" class="drive-icon"></a>');h.resizeFrame(a)}})},1)};a.edit=function(c){var b=l("filter")(a.songs,{id:c})[0];a.song=angular.copy(b);var k=d.open({scope:a,templateUrl:"editor.html",backdrop:"static",backdropClass:"light",keyboard:!1,controller:function(){a.submit=
function(){a.save().then(function(){Object.assign(b,h.pick(a.song,"title","category","author","others"));a.refresh();k.close()})};a.cancel=function(){k.close()}}});k.opened.then(function(){e(function(){h.scrollFrame()},100)})};a.search=function(a){$(".table").DataTable().search(a).draw()};a.save=function(){var b=c.defer(),d=h.pick(a.song,"id","title","author","category","others");a.song.refId?g.updateFile(a.song.refId,d).then(function(){b.resolve()}):g.createFile(d).then(function(){b.resolve()});
return b.promise};a.refresh=function(){a.categories=f.listCategories(a.songs);a.authors=f.listAuthors(a.songs);$(".table").DataTable().draw(!1)};a.loadData=function(){var b=c.defer();g.loadFiles().then(function(c){Array.prototype.push.apply(a.songs,c);a.categories=f.listCategories(a.songs);a.authors=f.listAuthors(a.songs);f.sortByLocale(a.songs,"title");b.resolve()});return b.promise}}]);
