var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)$jscomp.owns(d,e)&&(a[e]=d[e])}return a};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
app.controller("LibraryCtrl",["$scope","$q","$window","$uibModal","$timeout","$filter","$document","HttpService","DataService","FileService","AppUtil",function(a,b,c,d,e,l,m,n,f,g,h){a.init=function(){a.songs=[];a.categories=[];a.authors=[];a.song={};a.dateFormat="DD, dd/mm/yy";a.driveURL=g.getFolderURL("cadoan.sheets");a.pageSize=10;a.pageCounter=1;a.maxSize=7;m.ready(function(){0===c.angular.element(".signin").length&&a.loadData().then(function(){a.get()})})};a.signin=function(b,c){a.profile=b;
a.accessToken=c;n.setAccessToken(c);a.loadData().then(function(){a.get()})};a.get=function(){var b=[{width:"calc(50% - 16)",targets:0},{width:"35%",targets:1},{width:"15%",targets:2},{width:16,targets:3,visible:null!==a.accessToken&&void 0!==a.accessToken,searchable:!1,orderable:!1},{width:0,targets:4,visible:!1,type:"hidden"}];e(function(){$(".table").DataTable({language:{url:"../../resources/js/datatables-vi.json"},columns:b,autoWidth:!1,ordering:!1,pageLength:15,lengthMenu:[[10,15,25,50,-1],[10,
15,25,50,"All"]],dom:'<fpl<t>i<"dataTables_drive">>',initComplete:function(){a.accessToken&&$(".dataTables_drive").append('<a href="'+a.driveURL+'" target="_blank" title="Danh S\u00e1ch B\u00e0i H\u00e1t" class="drive-icon"></a>');h.resizeFrame(a)}})},1)};a.edit=function(b){var c=l("filter")(a.songs,{id:b})[0];a.song=angular.copy(c);var k=d.open({scope:a,templateUrl:"editor.html",backdrop:"static",backdropClass:"light",keyboard:!1,controller:function(){a.submit=function(){a.save().then(function(){Object.assign(c,
h.pick(a.song,"title","category","author","others"));a.refresh();k.close()})};a.cancel=function(){k.close()}}});k.opened.then(function(){e(function(){h.scrollFrame()},100)})};a.search=function(a){$(".table").DataTable().search(a).draw()};a.save=function(){var c=b.defer();g.updateFile(a.song.id,{description:JSON.stringify({title:a.song.title,author:a.song.author,category:a.song.category,others:a.song.others})}).then(function(){c.resolve()});return c.promise};a.refresh=function(){a.categories=f.listCategories(a.songs);
a.authors=f.listAuthors(a.songs);$(".table").DataTable().draw()};a.loadData=function(){var c=b.defer();b.all([g.listFolder("cadoan.sheets")]).then(function(b){b=$jscomp.makeIterator(b[0]);for(var d=b.next();!d.done;d=b.next())Array.prototype.push.apply(a.songs,d.value);a.categories=f.listCategories(a.songs);a.authors=f.listAuthors(a.songs);f.sortByLocale(a.songs,"title");c.resolve()});return c.promise}}]);
