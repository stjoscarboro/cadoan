app.controller("TestCtrl",function(a,c,e,f){a.init=function(){a.authorize().then(function(b){console.log(b)},function(b){console.log(b);a.error(b)})};a.authorize=function(){var b=c.defer();$.getJSON("../resources/js/stjoscarboro-api.json",function(a){var d={alg:"RS256",typ:"JWT"},c={iss:a.client_email,scope:"https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/spreadsheets",aud:a.token_uri,sub:Base64.decode(gapiids[0]),iat:KJUR.jws.IntDate.get("now"),exp:KJUR.jws.IntDate.get("now + 1hour")};
d=KJUR.jws.JWS.sign(d.alg,JSON.stringify(d),JSON.stringify(c),a.private_key);f.postFormData(a.token_uri,{grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:d}).then(function(a){b.resolve(a)},function(a){b.reject(a.data)})});return b.promise};a.error=function(b){a.error=JSON.stringify(b);var c=e.open({scope:a,templateUrl:"../resources/error.html",backdrop:"static",backdropClass:"light",keyboard:!1,controller:function(){a.cancel=function(){c.close()}}})}});
