app.factory("AirtableService",["$q","$http","AppUtil",function(e,g){var b={},d={};b.setConfig=function(h){d=h};b.getData=function(h){var c=e.defer(),a=[],f=function(c,b){var k=e.defer();g({url:c+(b?"&offset="+b:""),method:"GET"}).then(function(b){(b.data.records||[]).forEach(function(b){var c={refId:b.id};d.tables[h].fields.forEach(function(a){switch(!0){case "date"===a:var d=new Date(Date.parse(b.fields[a]));d.setTime(d.getTime()+6E4*d.getTimezoneOffset());c[a]=d;break;case Array.isArray(b.fields[a]):c[a]=
b.fields[a][0];break;default:c[a]=""+b.fields[a]}});a.push(c)});b.data.offset?f(c,b.data.offset).then(function(){k.resolve()}):k.resolve()},function(a){k.reject(a.error)});return k.promise};f(d.url+"/"+h+"?api_key="+d.key).then(function(){a.sort(function(a,b){return parseInt(a.id)-parseInt(b.id)});c.resolve(a)},function(a){console.log(a)});return c.promise};b.createData=function(b,c){var a=e.defer();g({url:d.url+"/"+b+"?api_key="+d.key,method:"POST",data:c}).then(function(){a.resolve()},function(a){console.log("Error: "+
a.error)});return a.promise};b.updateData=function(b,c,a){var f=e.defer();g({url:d.url+"/"+b+"/"+c+"?api_key="+d.key,method:"PUT",data:a}).then(function(){f.resolve()},function(a){console.log("Error: "+a.error)});return f.promise};b.deleteData=function(b,c){var a=e.defer();g({url:d.url+"/"+b+"/"+c+"?api_key="+d.key,method:"DELETE"}).then(function(){a.resolve()},function(a){console.log("Error: "+a.error)});return a.promise};return b}]);
