var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,c){a instanceof String&&(a=String(a));for(var b=a.length,f=0;f<b;f++){var k=a[f];if(d.call(c,k,f,a))return{i:f,v:k}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,c,b){if(d){c=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var f=a[b];f in c||(c[f]={});c=c[f]}a=a[a.length-1];b=c[a];d=d(b);d!=b&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.owns=function(a,d){return Object.prototype.hasOwnProperty.call(a,d)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,d){for(var c=1;c<arguments.length;c++){var b=arguments[c];if(b)for(var f in b)$jscomp.owns(b,f)&&(a[f]=b[f])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var d=0;return function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,d){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:d})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+d++,c)}var d=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,b={next:function(){if(c<a.length){var f=c++;return{value:d(f,a[f]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
app.factory("AirtableService",["$q","$http","AppUtil",function(a,d,c){var b={},f=Base64.decode("a2V5UUxrUm82andCeTdNWmg="),k={singers:{fields:["id","name"]},liturgies:{fields:["id","name","year","date","intention"]},schedules:{fields:["id","date","liturgy","songs"]}};b.getCategories=function(){return["Nh\u1eadp L\u1ec5","\u0110\u00e1p Ca","D\u00e2ng L\u1ec5","Hi\u1ec7p L\u1ec5","K\u1ebft L\u1ec5"]};b.loadSingers=function(){var g=a.defer();b.getData("singers").then(function(a){g.resolve(a)});return g.promise};
b.loadLiturgies=function(){var g=a.defer();b.getData("liturgies").then(function(a){g.resolve(a)});return g.promise};b.loadSchedules=function(g){var e=a.defer(),h=[];b.getData("schedules").then(function(a){a.forEach(function(a){var b=JSON.parse(a.songs);b.forEach(function(a){var b=g.find(function(b){return b.id===a.id});b&&Object.assign(a,c.pick(b,"title","category","author","audio","url","folder"))});h.push({id:a.id,refId:a.refId,date:a.date,liturgy:JSON.parse(a.liturgy),songs:b})});h.sort(function(a,
b){return a.date-b.date});e.resolve(h)});return e.promise};b.createSchedule=function(a){return b.createData("schedules",{fields:a})};b.updateSchedule=function(a,e){return b.updateData("schedules",a,{fields:e})};b.deleteSchedule=function(a){return b.deleteData("schedules",a)};b.listCategories=function(a){var e=a.reduce(function(a,b){a[b.category]=(a[b.category]||0)+1;return a},{});e=Object.keys(e).reduce(function(a,b){0<e[b]&&a.push(b);return a},[]);b.sortCategories(e);return e};b.listAuthors=function(a){var e=
a.reduce(function(a,b){a[b.author]=(a[b.author]||0)+1;return a},{});e=Object.keys(e).reduce(function(a,b){0<e[b]&&a.push(b);return a},[]);b.sortByLocale(e,"name");return e};b.sortByLocale=function(a,b){a&&a.sort(function(a,d){a="object"===typeof a&&b?a[b]:a;d="object"===typeof d&&b?d[b]:d;return a&&d?a.localeCompare(d):0})};b.sortCategories=function(a){b.sortByLocale(a);a&&a.sort(function(a,d){var c=b.getCategories().reverse();return c.indexOf(d)-c.indexOf(a)})};b.getData=function(b){var c=a.defer(),
h=[],g=function(c,e){var f=a.defer();d({url:c+(e?"&offset="+e:""),method:"GET"}).then(function(a){(a.data.records||[]).forEach(function(a){var d={refId:a.id};k[b].fields.forEach(function(b){switch(!0){case "date"===b:var c=new Date(Date.parse(a.fields[b]));c.setTime(c.getTime()+6E4*c.getTimezoneOffset());d[b]=c;break;case Array.isArray(a.fields[b]):d[b]=a.fields[b][0];break;default:d[b]=""+a.fields[b]}});h.push(d)});a.data.offset?g(c,a.data.offset).then(function(){f.resolve()}):f.resolve()},function(a){f.reject(a.error)});
return f.promise};g("https://api.airtable.com/v0/appct8Cpvuk7NtKiQ/"+b+"?api_key="+f).then(function(){h.sort(function(a,b){return parseInt(a.id)-parseInt(b.id)});c.resolve(h)},function(a){console.log(a)});return c.promise};b.createData=function(b,c){var e=a.defer();d({url:"https://api.airtable.com/v0/appct8Cpvuk7NtKiQ/"+b+"?api_key="+f,method:"POST",data:c}).then(function(){e.resolve()},function(a){console.log("Error: "+a.error)});return e.promise};b.updateData=function(b,c,h){var e=a.defer();d({url:"https://api.airtable.com/v0/appct8Cpvuk7NtKiQ/"+
b+"/"+c+"?api_key="+f,method:"PUT",data:h}).then(function(){e.resolve()},function(a){console.log("Error: "+a.error)});return e.promise};b.deleteData=function(b,c){var e=a.defer();d({url:"https://api.airtable.com/v0/appct8Cpvuk7NtKiQ/"+b+"/"+c+"?api_key="+f,method:"DELETE"}).then(function(){e.resolve()},function(a){console.log("Error: "+a.error)});return e.promise};return b}]);
